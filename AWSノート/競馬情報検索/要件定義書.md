# 競馬予想ブラウザアプリ 要件定義書

## 1. プロジェクト概要
* **目的:** JRA公式データ（JRA-VAN）を利用し、Webブラウザ上で出馬表、オッズ、成績データを閲覧・分析できる環境を構築する。

* **ターゲット:** 一般競馬ファン（および開発者自身）。

 **主要機能:** データの自動取得、レース情報の閲覧、過去データ検索、予想印の入力・保存。

## 2. システム構成（アーキテクチャ）
JRA-VANの仕様上、データ取得用サーバーとWebアプリ用サーバーを分離する構成とする。

* **データ取得サーバー (Windows):** JV-Linkを使用し、JRAからデータを取得・DBへ格納。
* **Webアプリケーションサーバー (Linux):** ユーザーからのアクセスを処理し、DBからデータを返却。
* **データベース (Aurora/RDS):** データを一元管理。

## 3. 機能要件

### 3.1. データ管理機能（バックエンド・バッチ）
| 機能ID | 機能名 | 詳細 |
| :--- | :--- | :--- |
| **B-01** | **JRAデータ取得** | JRA-VAN JV-Link APIを叩き、セットアップ/速報系データを取得する。 |
| **B-02** | **データ取込(ETL)** | 取得した固定長データを解析し、リレーショナルデータベース(RDB)へ格納する。 |
| **B-03** | **スケジュール実行** | 開催日の指定時間（例: 9:00〜16:30の10分毎）に速報データ（オッズ・結果）を自動取得する。 |

### 3.2. ユーザー機能（フロントエンド）
| 機能ID | 機能名 | 詳細 |
| :--- | :--- | :--- |

| **F-01** | **開催一覧表示** | 日付ごとの開催競馬場・レース一覧を表示する。 |
| **F-02** | **出馬表表示** | 馬番、馬名、騎手、斤量、過去走（近5走）などの基本情報を表形式で表示する。 |
| **F-03** | **調教表示** | 坂路1F～4FｍCW1F~6Fの調教タイムをそれぞれ表示する。過去の調教タイムも含めて表形式、グラフ形式で表示する。
| **F-04** | **競走馬検索** | 馬名検索により、過去の戦績（血統、タイム、着順）を表示する。 |
| **F-05** | **予想印入力** | ユーザーが出馬表に対して予想印（◎、○、▲など）を入力し、ブラウザ（Local StorageまたはDB）に保存する。 |

## 4. 非機能要件

* **可用性:** 土日の競馬開催時間帯（9:00〜17:00）に停止しないこと。

* **性能:** 出馬表の表示が1秒以内であること。

* **拡張性:** 将来的にAI予想モデル（Python等）と連携できるDB設計にすること。

## 5. 技術スタック

* **OS:** Windows Server (データ取得用), Linux (Webアプリ用)

* **言語:** Java (Maven), JavaScript (React or Vue.js)

* **DB:** PostgreSQL (Amazon Aurora PostgreSQL Compatible)

* **インフラ:** AWS (EC2, RDS)

* **ソース管理:** GitHub

---
## 月額運用費（ランニングコスト）
※AWSを利用する前提

| 項目 | サービス/プラン | 月額概算 (JPY) | 備考 |
| :--- | :--- | :--- | :--- |
| **データ利用料** | JRA-VAN Data Lab. | **2,090円** | 必須。JRA公式への支払い。 |
| **DBサーバー** | AWS RDS (PostgreSQL) | **約3,000円〜** | `db.t3.micro` (Auroraより安価な構成を推奨) |
| **Web/データサーバー** | AWS EC2 (Windows) | **約4,000円〜** | `t3.small` (JV-Link稼働用) |
| **Webアプリサーバー** | AWS App Runner / EC2 | **約1,500円〜** | コンテナまたはLinux EC2 |
| **その他** | Route53(ドメイン), S3 | **約500円** | ログ保存、ドメイン維持費 |
| **合計** | - | **約11,000円 /月** | ※稼働時間の調整で削減可能 |

